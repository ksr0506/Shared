통합언어쿼리 - LINQ(Language-INtegrated Query) in Visual Basic.NET

1. 람다 구문(식)[Lambda expression] (https://learn.microsoft.com/ko-kr/dotnet/visual-basic/programming-guide/language-features/procedures/lambda-expressions)
(1) Datatable.AsEnumerable().Select(Function(x) ~ )
(2) Datatable.Select(Function(x) ~ )
(3) Datatable.[Select](Function(x) ~ )

2. 질의형[Query] (https://learn.microsoft.com/ko-kr/dotnet/visual-basic/programming-guide/language-features/linq/how-to-query-a-database-by-using-linq)
(1) (From row in datatable.select
     Where ~
     Select row).CopyToTable

(2) (From row In io_dt_Qitem
     Where ("키" + row(str_Filter_ColumnName).toString).Contains(in_str_RunAndFilter_KeyValue)).CopyToDataTable
     
(3) (From s In array.AsEnumerable Select ~).ToArray)


(From row In dt_sample.Select
Where row("Age").Equals(11)
     Select row).CopyToDataTable.Rows(0)(0).ToString

dt_sample.Select("[Age]='11'").CopyToDataTable

(From row In dt_sample
Where row("Age").Equals(11)
     Select row).CopyToDataTable

dt_sample.AsEnumerable().Where(Function(row) row("Age").Equals(11)).CopyToDataTable.Rows(0)(0).ToString


(4) (From row In dt_monthlyBillDetail.AsEnumerable
Group row By sc = row("청구항목").ToString()
Into grp = Group
Let total= grp.sum(Function (x) Convert.ToDouble(x("당월청구금액").ToString().Replace(",", String.Empty).Replace("원", String.Empty).Trim()))
Let result = New Object() {grp(0)("청구항목"),total}
Select dt.rows.add(result)).CopyToDataTable

#해설#
Group by로 청구항목 합치고, 당월 청구 금액의 값 수정 후 합한 값 출력

dt_monthlyBillDetail
청구항목 | 당월 청구금액
A       | 3,000 원
B       | 2,000 원
A       | 1,500 원

dt
청구항목 | 당월 청구금액
A       | 4500
B       | 2000

(5) listVariable.AsEnumerable().Where(Function(x) Not String.IsNullOrEmpty(x)).ToList
-> 리스트의 값 중 Null 값을 제거

(6) listVariable.AsEnumerable().Where(Function(x) x.Contains(" 원")).ToList
-> 특정 키워드를 포함한 리스트의 값 추출

(7) ftpObjectInfo.AsEnumerable().Where(Function(x) x.Modified > Convert.ToDateTime("2023-12-10") and x.Modified < Convert.ToDateTime("2023-12-12")).Count
-> ftp Activity 중 Enumerate Objects로 반환 받은 파일 리스트(iEnumerable<FtpObjectInfo>)의 정보들 중 Modified 기준으로 필터하여 카운트 반환, 응용하여 필터 처리된 리스트(.ToList()) 반환 가능

(6) ftpObjectInfo.AsEnumerable().Where(Function(x) Path.GetExtension(x.Name).Equals(".pdf")).ToList
-> 파일리스트중 pdf파일만 리스트로 재선언

(7) System.ServiceProcess.ServiceController.GetServices.AsEnumerable().Where(Function(x) x.DisplayName.Equals("Credential Manager")).ToList()(0).DisplayName
-> 윈도우 서비스(작업관리자 > 서비스)의 리스트를 반환 받는데, 특정 이름으로 반환 받는데 별도 구조체에 담지 않고 바로 출력하기 (.ToList()(0)로 안하고 .First()나 .Last()로도 가능)
